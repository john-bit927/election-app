<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LGA Results</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    .election-card { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #333; border-radius: 15px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
    .comparison-table { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
    .party-color { padding: 5px 10px; border-radius: 20px; font-weight: bold; }
    .pdp { background: #e91e63; color: white; }
    .dpp { background: #9c27b0; color: white; }
    .acn { background: #f44336; color: white; }
    .ppa { background: #ff9800; color: white; }
    .cdc { background: #4caf50; color: white; }
    .jp { background: #2196f3; color: white; }
    .cpc { background: #ffeb3b; color: black; }
    .anpp { background: #795548; color: white; }
    .accord { background: #607d8b; color: white; }
    .diff-positive { background: rgba(76, 175, 80, 0.2); }
    .diff-negative { background: rgba(244, 67, 54, 0.2); }
  </style>
</head>
<body class="container mt-4">
  <div class="election-card p-4 mb-4 text-center">
    <h2><i class="fas fa-chart-bar me-2"></i>Aggregated LGA Results (Estimated vs Official)</h2>
  </div>
  <form method="get" class="mb-3">
    <div class="input-group w-50 mx-auto">
      <span class="input-group-text"><i class="fas fa-filter"></i></span>
      <select name="lga_id" class="form-select">
        <option value="">Select LGA</option>
        <% lgas.forEach(lga => { %>
          <option value="<%= lga.lga_id %>" <%= selectedLgaId == lga.lga_id ? 'selected' : '' %>><%= lga.lga_name %></option>
        <% }); %>
      </select>
      <button type="submit" class="btn btn-primary"><i class="fas fa-eye me-1"></i>Load</button>
    </div>
  </form>
  <% if (selectedLgaId) { %>
    <div class="card mb-4">
      <div class="card-header bg-info text-white text-center">
        <h4><i class="fas fa-map me-2"></i>Results for LGA ID: <%= selectedLgaId %></h4>
      </div>
      <div class="card-body p-0">
        <table class="table table-striped mb-0 comparison-table">
          <thead class="table-dark">
            <tr><th>Party</th><th>Estimated (Sum PUs)</th><th>Official</th><th>Difference (Official - Est)</th></tr>
          </thead>
          <tbody>
            <% PARTIES.forEach(party => { %>
              <tr class="<%= (comparison[party] > 0 ? 'diff-positive' : comparison[party] < 0 ? 'diff-negative' : '') %>">
                <td><span class="party-color <%= party.toLowerCase() %>"><%= party %></span></td>
                <td class="fw-bold"><%= estimated[party] || 0 %></td>
                <td class="fw-bold"><%= official[party] || 0 %></td>
                <td class="fw-bold <%- (comparison[party] > 0 ? 'text-success' : comparison[party] < 0 ? 'text-danger' : '') %>"><%= comparison[party] || 0 %></td>
              </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
    </div>
  <% } else { %>
    <div class="alert alert-info text-center">
      <i class="fas fa-info-circle me-2"></i>Select an LGA to compare estimated totals from PUs vs. official announcements.
    </div>
  <% } %>
  <div class="text-center">
    <a href="/" class="btn btn-secondary"><i class="fas fa-home me-1"></i>Home</a>
  </div>
</body>
</html>